# PDF发票拼接工具 - 使用说明

## 功能特点

✅ **支持ZIP压缩包** - 将发票PDF文件打包成ZIP上传，自动保持文件顺序
✅ **支持多文件上传** - 直接选择多个PDF文件上传
✅ **智能排序** - 自动按文件名进行自然排序（支持数字排序）
✅ **自动拼接** - 每两张发票自动拼接成一张PDF（上下排列）
✅ **奇数处理** - 如果是奇数张发票，最后一页下半部分自动留空
✅ **保持原样** - **完全保持原始PDF的尺寸**，不缩放、不拉伸、不变形、不裁剪
✅ **批量输出** - 拼接完成后自动打包成ZIP压缩包，包含所有拼接好的PDF文件

## 使用方法

### 方法一：上传ZIP压缩包（推荐）

1. 将所有PDF发票文件放入一个文件夹
2. 确保文件名按照你想要的顺序命名（例如：`001.pdf`, `002.pdf`, `003.pdf`...）
3. 将文件夹压缩成ZIP格式
4. 在浏览器中打开 `invoice_merger.html`
5. 点击或拖拽ZIP文件到上传区域
6. 工具会自动解压并按文件名排序
7. 查看文件列表确认顺序
8. 点击"开始拼接"按钮
9. 等待处理完成，会自动下载包含所有拼接好PDF的ZIP压缩包

### 方法二：直接上传多个PDF

1. 在浏览器中打开 `invoice_merger.html`
2. 点击上传区域
3. 按住 Ctrl（Windows）或 Command（Mac）选择多个PDF文件
4. 文件会自动按文件名排序
5. 查看文件列表确认顺序
6. 点击"开始拼接"按钮
7. 等待处理完成，会自动下载包含所有拼接好PDF的ZIP压缩包

## 文件命名建议

为了确保正确的排序顺序，建议使用以下命名方式：

### 推荐格式

- `001.pdf`, `002.pdf`, `003.pdf`, ... `099.pdf`, `100.pdf`
- `发票_001.pdf`, `发票_002.pdf`, `发票_003.pdf`
- `2024-01-01.pdf`, `2024-01-02.pdf`, `2024-01-03.pdf`

### 避免的格式

- `1.pdf`, `2.pdf`, ... `10.pdf` - 可能导致排序问题（虽然工具支持自然排序）
- 使用随机文件名或日期戳

## 拼接规则

工具按照以下规则进行拼接：

```
输入100张A5发票（001.pdf ~ 100.pdf）：

第1张和第2张 → 拼接_001.pdf（A4，上下排列）
第3张和第4张 → 拼接_002.pdf（A4，上下排列）
第5张和第6张 → 拼接_003.pdf（A4，上下排列）
...以此类推
第99张和第100张 → 拼接_050.pdf（A4，上下排列）

最终生成50个A4 PDF文件，打包成ZIP下载
```

```
如果输入为奇数（例如5张A5发票）：

第1张和第2张 → 拼接_001.pdf
第3张和第4张 → 拼接_002.pdf
第5张 → 拼接_003.pdf（下半部分留空）

最终生成3个A4 PDF文件，打包成ZIP下载
```

## 技术规格

- **输入格式**: PDF文件或ZIP压缩包
- **输出格式**: ZIP压缩包（包含多个拼接后的PDF文件）
- **输出命名**: 拼接_001.pdf, 拼接_002.pdf, 拼接_003.pdf...
- **页面尺寸**: 自动适应原始PDF尺寸（不固定为A4/A5）
- **尺寸处理**: 完全保持原始PDF尺寸，不做任何缩放或变形
- **拼接方式**: 上下拼接，如两张尺寸不同则以宽度最大者为准，居中对齐
- **最大文件数**: 100个PDF文件
- **渲染质量**: 2倍缩放渲染（保证清晰度）
- **压缩级别**: DEFLATE Level 6（平衡压缩率和速度）
- **处理方式**: 纯浏览器端处理，无需上传到服务器

## 系统要求

- 现代浏览器（Chrome、Firefox、Edge、Safari）
- 支持JavaScript
- 稳定的网络连接（用于加载CDN库）

## 准备测试ZIP文件示例

### Windows示例

```powershell
# 创建测试文件夹
mkdir 发票文件
cd 发票文件

# 将PDF文件复制到这个文件夹并重命名
# 001.pdf, 002.pdf, 003.pdf ...

# 压缩文件夹（右键 → 发送到 → 压缩文件夹）
# 或使用命令
Compress-Archive -Path *.pdf -DestinationPath ../发票.zip
```

### Mac/Linux示例

```bash
# 创建测试文件夹
mkdir 发票文件
cd 发票文件

# 将PDF文件复制到这个文件夹并重命名
# 001.pdf, 002.pdf, 003.pdf ...

# 压缩文件夹
zip -r ../发票.zip *.pdf
```

## 常见问题

### Q: 文件顺序不正确怎么办？

A: 工具会按文件名进行自然排序。请确保文件名包含数字编号，建议使用前导零（如001、002）来保证正确排序。

### Q: 可以上传多个ZIP文件吗？

A: 可以。工具会解压所有ZIP文件，提取其中的PDF，然后统一排序。

### Q: ZIP文件中有子文件夹怎么办？

A: 工具会递归提取所有PDF文件，不管它们在哪个子文件夹中，都会被提取出来并排序。

### Q: 发票尺寸不是标准尺寸怎么办？

A: 完全没问题！工具会自动读取每个PDF的原始尺寸，并完全保持不变。无论是A4、A5、B5还是任何自定义尺寸，都可以正常拼接。

### Q: 两张发票尺寸不同怎么办？

A: 工具会智能处理：
- 输出PDF的宽度 = 两张发票中较宽的那张
- 输出PDF的高度 = 两张发票高度之和
- 较窄的发票会居中对齐
- 完全保持每张发票的原始尺寸，不缩放

### Q: 处理速度慢怎么办？

A: 处理速度取决于：
1. PDF文件大小和数量
2. 计算机性能
3. 浏览器性能

建议：
- 一次处理不超过50个文件
- 使用现代浏览器
- 关闭其他占用资源的程序

### Q: 生成的ZIP文件太大怎么办？

A: 
- 工具使用PNG格式进行转换，PDF文件可能较大
- ZIP压缩使用DEFLATE Level 6，已经进行了压缩
- 如需进一步压缩，可以解压后使用专业PDF压缩工具
- 建议原始发票PDF文件不要过大（每个≤2MB）

### Q: 输出的PDF文件数量是多少？

A: 输出的PDF数量 = ⌈输入PDF数量 ÷ 2⌉
- 10张输入 → 5个PDF输出
- 50张输入 → 25个PDF输出  
- 100张输入 → 50个PDF输出
- 99张输入 → 50个PDF输出（最后一个留空）

## 隐私说明

🔒 **完全本地处理** - 所有文件处理都在您的浏览器中完成，不会上传到任何服务器。您的发票数据完全安全和私密。

## 技术支持

如有问题或建议，请检查：
1. 浏览器控制台是否有错误信息
2. 文件格式是否正确
3. 网络连接是否正常（需要加载CDN库）

---

*最后更新: 2025年10月*

