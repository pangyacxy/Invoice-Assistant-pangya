# PDF发票拼接工具 - 使用示例

## 📦 输入输出示例

### 示例 1：偶数张发票

**输入：** 上传包含以下6个PDF的ZIP文件
```
发票.zip
├── 001.pdf  (A5发票)
├── 002.pdf  (A5发票)
├── 003.pdf  (A5发票)
├── 004.pdf  (A5发票)
├── 005.pdf  (A5发票)
└── 006.pdf  (A5发票)
```

**输出：** 自动下载 `发票拼接_2025-10-28-14-30-00.zip`
```
发票拼接_2025-10-28-14-30-00.zip
├── 拼接_001.pdf  (A4发票，包含001和002)
├── 拼接_002.pdf  (A4发票，包含003和004)
└── 拼接_003.pdf  (A4发票，包含005和006)
```

### 示例 2：奇数张发票

**输入：** 上传包含以下5个PDF的ZIP文件
```
发票.zip
├── 001.pdf  (A5发票)
├── 002.pdf  (A5发票)
├── 003.pdf  (A5发票)
├── 004.pdf  (A5发票)
└── 005.pdf  (A5发票)
```

**输出：** 自动下载 `发票拼接_2025-10-28-14-30-00.zip`
```
发票拼接_2025-10-28-14-30-00.zip
├── 拼接_001.pdf  (A4发票，包含001和002)
├── 拼接_002.pdf  (A4发票，包含003和004)
└── 拼接_003.pdf  (A4发票，包含005，下半部分空白)
```

### 示例 3：大批量处理

**输入：** 上传包含100个PDF的ZIP文件
```
发票批量.zip
├── 001.pdf
├── 002.pdf
├── 003.pdf
├── ...
├── 098.pdf
├── 099.pdf
└── 100.pdf
```

**输出：** 自动下载 `发票拼接_2025-10-28-14-30-00.zip`
```
发票拼接_2025-10-28-14-30-00.zip
├── 拼接_001.pdf  (包含001和002)
├── 拼接_002.pdf  (包含003和004)
├── 拼接_003.pdf  (包含005和006)
├── ...
├── 拼接_049.pdf  (包含097和098)
└── 拼接_050.pdf  (包含099和100)
```

## 🖼️ 拼接布局示例

### 情况1：两张发票尺寸相同

```
┌─────────────────────────┐
│                         │
│     第1张发票           │  ← 原始尺寸，不缩放
│                         │
│─────────────────────────│  ← 分界线
│                         │
│     第2张发票           │  ← 原始尺寸，不缩放
│                         │
└─────────────────────────┘
   输出PDF（高度=两张之和）
```

### 情况2：两张发票宽度不同

```
┌─────────────────────────────┐
│                             │
│    第1张发票（较窄）        │  ← 居中对齐，原始尺寸
│                             │
│─────────────────────────────│
│                             │
│   第2张发票（较宽）         │  ← 原始尺寸
│                             │
└─────────────────────────────┘
  输出PDF宽度=较宽的那张
```

### 情况3：最后一张为奇数

```
┌─────────────────────────┐
│                         │
│     第N张发票           │  ← 原始尺寸（有内容）
│                         │
└─────────────────────────┘
   输出PDF（只有一张高度）

注意：如果是奇数，最后一个PDF只包含一张发票，
不会在下方添加空白区域。
```

## 🔍 尺寸保持原理

### 工具如何保证不改变原图尺寸？

1. **读取原始尺寸**
   - 工具读取每个PDF页面的原始尺寸（以点为单位，72 DPI）
   - 例如：A5纸张 = 420 × 595 点

2. **高质量渲染**
   - 使用2倍分辨率渲染（保证清晰度）
   - 渲染后转换为PNG图像

3. **按原尺寸放置**
   - 在新PDF中，使用读取到的原始尺寸放置图像
   - 明确指定不进行任何压缩或变形（'NONE' 参数）
   - 结果：图像保持100%原始尺寸

4. **智能拼接**
   - 输出PDF尺寸 = 原始尺寸的精确组合
   - 宽度：取两张中较宽的
   - 高度：两张高度相加
   - 无任何拉伸或压缩

### 技术对比

| 操作 | 其他工具可能做的 | 本工具做的 |
|-----|---------------|-----------|
| 读取PDF | 按固定DPI转换 | 读取原始点尺寸 |
| 渲染 | 固定分辨率 | 高分辨率渲染但记住原尺寸 |
| 放置 | 缩放到A4 | 按原始尺寸精确放置 |
| 输出 | 固定页面尺寸 | 动态计算页面尺寸 |

**保证：** 如果输入是420×595点，输出就是420×595点，分毫不差！

## 🎯 实际使用场景

### 场景1：月度发票整理

**需求：** 整理一个月的100张发票，方便打印和存档

**步骤：**
1. 收集所有发票PDF文件
2. 按日期命名：`2024-10-01.pdf`, `2024-10-02.pdf`, ...
3. 压缩成 `2024年10月发票.zip`
4. 使用工具拼接
5. 得到50个A4 PDF文件
6. 可以直接打印，每页包含2张发票

### 场景2：报销单据准备

**需求：** 准备报销单据，每张A4纸贴两张发票

**步骤：**
1. 扫描所有发票为A5 PDF
2. 命名为：`发票_001.pdf`, `发票_002.pdf`, ...
3. 使用工具拼接
4. 打印输出的PDF
5. 按页数粘贴到报销单上

### 场景3：会计档案管理

**需求：** 将电子发票整理归档，节省存储空间

**步骤：**
1. 从各系统导出发票PDF
2. 重命名确保顺序
3. 打包成ZIP上传
4. 拼接后得到压缩包
5. 归档存储，占用空间减半

## ⚡ 性能参考

基于现代浏览器（Chrome/Edge）和中等配置电脑：

| 输入文件数 | 输出文件数 | 预计处理时间 |
|-----------|-----------|-------------|
| 10张      | 5个       | ~10秒       |
| 20张      | 10个      | ~20秒       |
| 50张      | 25个      | ~50秒       |
| 100张     | 50个      | ~2分钟      |

*实际时间取决于：*
- 原始PDF文件大小
- 计算机性能
- 浏览器版本
- 系统负载

## 💡 最佳实践

### 文件命名规范

✅ **推荐：**
```
001.pdf, 002.pdf, 003.pdf, ..., 099.pdf, 100.pdf
```

✅ **也可以：**
```
2024-10-01_发票.pdf
2024-10-02_发票.pdf
2024-10-03_发票.pdf
```

✅ **还可以：**
```
A公司_001.pdf
A公司_002.pdf
B公司_001.pdf
B公司_002.pdf
```

❌ **避免：**
```
发票.pdf
发票(1).pdf
发票 - 副本.pdf
新建文件夹/发票.pdf
```

### 批量重命名技巧

**Windows (PowerShell):**
```powershell
# 批量重命名为 001.pdf, 002.pdf, ...
Get-ChildItem *.pdf | ForEach-Object -Begin {$i=1} -Process {
    Rename-Item $_ -NewName ("发票_{0:D3}.pdf" -f $i++)
}
```

**Mac/Linux (bash):**
```bash
# 批量重命名为 001.pdf, 002.pdf, ...
i=1
for file in *.pdf; do
    mv "$file" "$(printf '发票_%03d.pdf' $i)"
    ((i++))
done
```

## 📞 故障排除

### 问题1：ZIP文件上传后没反应

**解决方案：**
- 检查ZIP文件是否损坏
- 确保ZIP内包含PDF文件
- 查看浏览器控制台是否有错误（按F12）
- 刷新页面重试

### 问题2：文件顺序不对

**解决方案：**
- 检查原始文件命名
- 使用数字前导零（001而不是1）
- 确保所有文件名格式统一

### 问题3：生成的PDF文件过大

**解决方案：**
- 降低原始PDF的分辨率
- 使用PDF压缩工具预处理
- 分批处理（每次处理50张以内）

### 问题4：浏览器崩溃或卡死

**解决方案：**
- 减少一次处理的文件数量
- 关闭其他占用内存的程序
- 使用最新版本的Chrome或Edge浏览器
- 清理浏览器缓存

## 🎬 快速开始

1. **下载文件：** `invoice_merger.html`
2. **双击打开：** 用浏览器打开HTML文件
3. **准备发票：** 确保文件名有序
4. **上传处理：** 拖拽ZIP或选择PDF
5. **下载结果：** 等待自动下载ZIP

就是这么简单！🎉

---

*如有任何问题，请参考 `invoice_merger_README.md` 获取详细说明*


